mutate(commod1 = str_trim(commod1)) %>%
filter(commod1 == "Gold" |commod1 == "Silver" |commod1 =="Copper" |commod1 == "Lead" |commod1 == "Iron") %>%
group_by(commod1,state) %>%
count() %>%
group_walk(~ write.csv(.x, paste0("metal_groups/",.y$commod1, "_total.csv")))
list.files(temp, pattern = "csv$")
View(ores_state)
dir.create(temp <- tempfile())
ores %>%
mutate(commod1 = str_trim(commod1)) %>%
filter(commod1 == "Gold" |commod1 == "Silver" |commod1 =="Copper" |commod1 == "Lead" |commod1 == "Iron") %>%
group_by(commod1,state) %>%
count()
View(ores_state)
View(ores_state)
ores_state <- ores %>%
mutate(commod1 = str_trim(commod1)) %>%
filter(commod1 == "Gold" |commod1 == "Silver" |commod1 =="Copper" |commod1 == "Lead" |commod1 == "Iron") %>%
merge(state_id,by = "state", all.y = TRUE) %>%
group_by(state,commod1) %>%
count()
ores_state <- ores_state[,c(1,2,3,4)]
View(ores_state)
ores_state <- ores %>%
mutate(commod1 = str_trim(commod1)) %>%
filter(commod1 == "Gold" |commod1 == "Silver" |commod1 =="Copper" |commod1 == "Lead" |commod1 == "Iron") %>%
merge(state_id,by = "state", all.y = TRUE) %>%
group_by(state,commod1,id) %>%
count()
ores_state <- ores_state[,c(1,2,3,4)]
colnames(ores_state) <- c("state","Metal","Number Of Deposits","id")
write.csv(ores_state,"topdeposits_bystate.csv")
View(ores_state)
ores_state <- ores %>%
mutate(commod1 = str_trim(commod1)) %>%
filter(commod1 == "Gold" |commod1 == "Silver" |commod1 =="Copper" |commod1 == "Lead" |commod1 == "Iron") %>%
group_by(state,commod1) %>%
count()  %>%
merge(state_id,by = "state", all.y = TRUE)
ores_state <- ores_state[,c(1,2,3,4)]
colnames(ores_state) <- c("state","Metal","Number Of Deposits","id")
write.csv(ores_state,"topdeposits_bystate.csv")
ores_state <- ores %>%
mutate(commod1 = str_trim(commod1)) %>%
filter(commod1 == "Gold") %>%
group_by(state,commod1) %>%
count()  %>%
merge(state_id,by = "state", all.y = TRUE)
ores_state <- ores_state[,c(1,2,3,4)]
colnames(ores_state) <- c("state","Metal","Number Of Deposits","id")
write.csv(ores_state,"topdeposits_bystate.csv")
View(ores_state)
ores_state <- ores %>%
mutate(commod1 = str_trim(commod1)) %>%
filter(commod1 == "Gold" |commod1 == "Silver" |commod1 =="Copper" |commod1 == "Lead" |commod1 == "Iron") %>%
group_by(state,commod1) %>%
count()  %>%
merge(state_id,by = "state", all.y = TRUE)
ores_state <- ores_state[,c(1,2,3,4)]
colnames(ores_state) <- c("state","Metal","Number Of Deposits","id")
write.csv(ores_state,"topdeposits_bystate.csv")
dir.create(temp <- tempfile())
ores %>%
mutate(commod1 = str_trim(commod1)) %>%
filter(commod1 == "Gold" |commod1 == "Silver" |commod1 =="Copper" |commod1 == "Lead" |commod1 == "Iron") %>%
group_by(commod1,state) %>%
count()
dir.create(temp <- tempfile())
ores %>%
mutate(commod1 = str_trim(commod1)) %>%
filter(commod1 == "Gold" |commod1 == "Silver" |commod1 =="Copper" |commod1 == "Lead" |commod1 == "Iron") %>%
group_by(commod1,state) %>%
count()  %>%
group_walk(~ write.csv(.x, paste0("metal_groups/",.y$commod1, ".csv")))
list.files(temp, pattern = "csv$")
dir.create(temp <- tempfile())
ores %>%
mutate(commod1 = str_trim(commod1)) %>%
filter(commod1 == "Gold" |commod1 == "Silver" |commod1 =="Copper" |commod1 == "Lead" |commod1 == "Iron") %>%
group_by(commod1) %>%
count()  %>%
group_walk(~ write.csv(.x, paste0("metal_groups/",.y$commod1, ".csv")))
dir.create(temp <- tempfile())
ores %>%
mutate(commod1 = str_trim(commod1)) %>%
filter(commod1 == "Gold" |commod1 == "Silver" |commod1 =="Copper" |commod1 == "Lead" |commod1 == "Iron") %>%
group_by(commod1) %>%
count()  %>%
group_walk(~ write.csv(.x, paste0("metal_groups/",.y$commod1, ".csv")))
list.files(temp, pattern = "csv$")
dir.create(temp <- tempfile())
ores %>%
mutate(commod1 = str_trim(commod1)) %>%
filter(commod1 == "Gold" |commod1 == "Silver" |commod1 =="Copper" |commod1 == "Lead" |commod1 == "Iron") %>%
group_by(commod1,state) %>%
count()  %>%
group_walk(~ write.csv(paste0("metal_groups/",.y$commod1, ".csv")))
list.files(temp, pattern = "csv$")
dir.create(temp <- tempfile())
ores %>%
mutate(commod1 = str_trim(commod1)) %>%
filter(commod1 == "Gold" |commod1 == "Silver" |commod1 =="Copper" |commod1 == "Lead" |commod1 == "Iron") %>%
group_by(commod1) %>%
count()  %>%
group_walk(~ write.csv(, paste0("metal_groups/",.y$commod1, ".csv")))
dir.create(temp <- tempfile())
ores %>%
mutate(commod1 = str_trim(commod1)) %>%
filter(commod1 == "Gold") %>%
group_by(state) %>%
count()  %>%
dir.create(temp <- tempfile())
ores %>%
mutate(commod1 = str_trim(commod1)) %>%
filter(commod1 == "Gold") %>%
group_by(state) %>%
count()
dir.create(temp <- tempfile())
ores %>%
mutate(commod1 = str_trim(commod1)) %>%
filter(commod1 == "Gold") %>%
group_by(state) %>%
count() %>%
merge(state_id,by = "state", all.y = TRUE)
View(state_id)
dir.create(temp <- tempfile())
ores_gold <- ores %>%
mutate(commod1 = str_trim(commod1)) %>%
filter(commod1 == "Gold") %>%
group_by(state) %>%
count() %>%
merge(state_id[1:2,],by = "state", all.y = TRUE)
dir.create(temp <- tempfile())
<- ores %>%
dir.create(temp <- tempfile())
ores %>%
mutate(commod1 = str_trim(commod1)) %>%
filter(commod1 == "Gold") %>%
group_by(state) %>%
count() %>%
merge(state_id[1:2,],by = "state", all.y = TRUE)
dir.create(temp <- tempfile())
ores %>%
mutate(commod1 = str_trim(commod1)) %>%
filter(commod1 == "Gold") %>%
group_by(state) %>%
count() %>%
merge(state_id[,1:2],by = "state", all.y = TRUE)
dir.create(temp <- tempfile())
vec <- c("Gold", "Silver","Copper","Lead","Iron")
for(i in 1:5){
ores %>%
mutate(commod1 = str_trim(commod1)) %>%
filter(commod1 == c[i]) %>%
group_by(state) %>%
count() %>%
merge(state_id[,1:2],by = "state", all.y = TRUE)
}
dir.create(temp <- tempfile())
vec <- c("Gold", "Silver","Copper","Lead","Iron")
for(i in 1:5){
ores %>%
mutate(commod1 = str_trim(commod1)) %>%
filter(commod1 == vec[i]) %>%
group_by(state) %>%
count() %>%
merge(state_id[,1:2],by = "state", all.y = TRUE)
}
dir.create(temp <- tempfile())
vec <- c("Gold", "Silver","Copper","Lead","Iron")
for(i in 1:5){
ores %>%
mutate(commod1 = str_trim(commod1)) %>%
filter(commod1 == vec[i]) %>%
group_by(state) %>%
count() %>%
merge(state_id[,1:2],by = "state", all.y = TRUE) %>%
write.csv(paste0("metal_groups/",vec[i], ".csv"))
}
dir.create(temp <- tempfile())
vec <- c("Gold", "Silver","Copper","Lead","Iron")
for(i in 1:5){
ores %>%
mutate(commod1 = str_trim(commod1)) %>%
filter(commod1 == vec[i]) %>%
group_by(state) %>%
count() %>%
merge(state_id[,1:2],by = "state") %>%
write.csv(paste0("metal_groups/",vec[i], ".csv"))
}
dir.create(temp <- tempfile())
vec <- c("Gold", "Silver","Copper","Lead","Iron")
for(i in 1:5){
ores %>%
mutate(commod1 = str_trim(commod1)) %>%
filter(commod1 == vec[i]) %>%
group_by(state) %>%
count() %>%
merge(state_id[,1:2],by = "state",all.y = TRUE) %>%
write.csv(paste0("metal_groups/",vec[i], ".csv"))
}
dir.create(temp <- tempfile())
vec <- c("Gold", "Silver","Copper","Lead","Iron")
for(i in 1:5){
ores %>%
mutate(commod1 = str_trim(commod1)) %>%
filter(commod1 == vec[i]) %>%
group_by(state) %>%
count() %>%
merge(state_id[,1:2],by = "state",all.y = TRUE) %>%
mutate_if(is.integer, ~replace(., is.na(.), 0))
write.csv(paste0("metal_groups/",vec[i], ".csv"))
}
ores %>%
mutate(commod1 = str_trim(commod1)) %>%
filter(commod1 == vec[i]) %>%
group_by(state) %>%
count() %>%
merge(state_id[,1:2],by = "state",all.y = TRUE) %>%
mutate(is.integer, ~replace(., is.na(.), 0))
ores_test <- ores %>%
mutate(commod1 = str_trim(commod1)) %>%
filter(commod1 == "Iron") %>%
group_by(state) %>%
count() %>%
merge(state_id[,1:2],by = "state",all.y = TRUE)
ores_test <- ores %>%
mutate(commod1 = str_trim(commod1)) %>%
filter(commod1 == "Iron") %>%
group_by(state) %>%
count() %>%
merge(state_id[,1:2],by = "state",all.y = TRUE)
ores_test
View(ores_test)
ores_test <- ores %>%
mutate(commod1 = str_trim(commod1)) %>%
filter(commod1 == "Iron") %>%
group_by(state) %>%
count() %>%
merge(state_id[,1:2],by = "state",all.y = TRUE)
ores_test[is.na(ores_test$n)] <- 0
View(ores_test)
ores_test <- ores %>%
mutate(commod1 = str_trim(commod1)) %>%
filter(commod1 == "Iron") %>%
group_by(state) %>%
count() %>%
merge(state_id[,1:2],by = "state",all.y = TRUE)
ores_test[,is.na(ores_test$n)] <- 0
ores_test <- ores %>%
mutate(commod1 = str_trim(commod1)) %>%
filter(commod1 == "Iron") %>%
group_by(state) %>%
count() %>%
merge(state_id[,1:2],by = "state",all.y = TRUE)
ores_test <- mutate_all(ores_test, ~replace_na(.,0))
ores_test <- ores %>%
mutate(commod1 = str_trim(commod1)) %>%
filter(commod1 == "Iron") %>%
group_by(state) %>%
count() %>%
merge(state_id[,1:2],by = "state",all.y = TRUE)
ores_test <- mutate_all(ores_test$n, ~replace_na(.,0))
ores_test <- ores %>%
mutate(commod1 = str_trim(commod1)) %>%
filter(commod1 == "Iron") %>%
group_by(state) %>%
count() %>%
merge(state_id[,1:2],by = "state",all.y = TRUE)
mutate_at(ores_test$n, ~replace_na(.,0))
ores_test <- ores %>%
mutate(commod1 = str_trim(commod1)) %>%
filter(commod1 == "Iron") %>%
group_by(state) %>%
count() %>%
merge(state_id[,1:2],by = "state",all.y = TRUE)
is.na(ores_test$n)
ores_test <- ores %>%
mutate(commod1 = str_trim(commod1)) %>%
filter(commod1 == "Iron") %>%
group_by(state) %>%
count() %>%
merge(state_id[,1:2],by = "state",all.y = TRUE)
ores_test$n[is.na(ores_test$n)]
ores_test <- ores %>%
mutate(commod1 = str_trim(commod1)) %>%
filter(commod1 == "Iron") %>%
group_by(state) %>%
count() %>%
merge(state_id[,1:2],by = "state",all.y = TRUE)
ores_test$n[is.na(ores_test$n)] <- 0
View(ores_test)
dir.create(temp <- tempfile())
vec <- c("Gold", "Silver","Copper","Lead","Iron")
for(i in 1:5){
ores_arr <- ores %>%
mutate(commod1 = str_trim(commod1)) %>%
filter(commod1 == vec[i]) %>%
group_by(state) %>%
count() %>%
merge(state_id[,1:2],by = "state",all.y = TRUE)
ores_arr$n[is.na(ores_arr$n)] <- 0
write.csv(ores_arr ,paste0("metal_groups/",vec[i], ".csv"))
}
View(ores_arr)
dir.create(temp <- tempfile())
vec <- c("Gold", "Silver","Copper","Lead","Iron")
for(i in 1:5){
ores_arr <- ores %>%
mutate(commod1 = str_trim(commod1)) %>%
filter(commod1 == vec[i]) %>%
group_by(state) %>%
count() %>%
merge(state_id[,1:2],by = "state",all.y = TRUE)
ores_arr$n[is.na(ores_arr$n)] <- 0
colnames(ores_arr) <- c("state", "number of Deposits" , "id")
write.csv(ores_arr ,paste0("metal_groups/",vec[i], ".csv"))
}
ores_state <- ores %>%
mutate(commod1 = str_trim(commod1)) %>%
group_by(state,commod1) %>%
count()  %>%
merge(state_id,by = "state", all.y = TRUE)
ores_state <- ores_state[,c(1,2,3,4)]
colnames(ores_state) <- c("state","Metal","Number Of Deposits","id")
write.csv(ores_state,"alleposits_bystate.csv")
View(ores_state)
ores_state <- ores %>%
mutate(commod1 = str_trim(commod1)) %>%
filter(commod1 == "Gold" |commod1 == "Silver" |commod1 =="Copper" |commod1 == "Lead" |commod1 == "Iron") %>%
group_by(state,commod1) %>%
count()  %>%
top_n(10)
merge(state_id,by = "state", all.y = TRUE)
View(ores_state)
View(state_group)
View(ores_state)
ores_state <- ores %>%
mutate(commod1 = str_trim(commod1)) %>%
filter(commod1 == "Gold" |commod1 == "Silver" |commod1 =="Copper" |commod1 == "Lead" |commod1 == "Iron") %>%
group_by(state,commod1) %>%
count()  %>%
merge(state_id,by = "state", all.y = TRUE)
ores_state <- ores_state[,c(1,2,3,4)]
colnames(ores_state) <- c("state","Metal","Number Of Deposits","id")
write.csv(ores_state,"topdeposits_bystate.csv")
ores_state <- ores %>%
mutate(commod1 = str_trim(commod1)) %>%
group_by(state,commod1) %>%
count()  %>%
merge(state_id,by = "state", all.y = TRUE)
ores_state <- ores_state[,c(1,2,3,4)]
colnames(ores_state) <- c("state","Metal","Number Of Deposits","id")
write.csv(ores_state,"alleposits_bystate.csv")
ores_state <- ores %>%
mutate(commod1 = str_trim(commod1)) %>%
group_by(state,commod1) %>%
count()  %>%
top_n(10)
merge(state_id,by = "state", all.y = TRUE)
ores_state <- ores %>%
mutate(commod1 = str_trim(commod1)) %>%
group_by(state,commod1) %>%
count()  %>%
top_n(10) %>%
merge(state_id,by = "state", all.y = TRUE)
ores_state <- ores_state[,c(1,2,3,4)]
colnames(ores_state) <- c("state","Metal","Number Of Deposits","id")
write.csv(ores_state,"alleposits_bystate.csv")
View(ores_state)
ores_state <- ores %>%
mutate(commod1 = str_trim(commod1)) %>%
group_by(state,commod1) %>%
count()  %>%
slice_max(order_by = n, n = 10)
merge(state_id,by = "state", all.y = TRUE)
ores_state <- ores %>%
mutate(commod1 = str_trim(commod1)) %>%
group_by(state,commod1) %>%
count()  %>%
slice_max(order_by = n, n = 10) %>%
merge(state_id,by = "state", all.y = TRUE)
ores_state <- ores_state[,c(1,2,3,4)]
colnames(ores_state) <- c("state","Metal","Number Of Deposits","id")
write.csv(ores_state,"alleposits_bystate.csv")
View(ores_state)
ores_state <- ores %>%
mutate(commod1 = str_trim(commod1)) %>%
group_by(state,commod1) %>%
count()  %>%
slice_max(order_by = n, n = 10)
ores %>%
mutate(commod1 = str_trim(commod1)) %>%
group_by(state,commod1) %>%
count()  %>%
slice_max(order_by = n, n = 10)
ores %>%
mutate(commod1 = str_trim(commod1)) %>%
group_by(state,commod1) %>%
count()  %>%
slice_max(order_by = n, n = 5)
ores %>%
mutate(commod1 = str_trim(commod1)) %>%
group_by(state,commod1) %>%
count()  %>%
arrange(desc(n)) %>%
slice(1:3)
ores %>%
mutate(commod1 = str_trim(commod1)) %>%
group_by(state,commod1) %>%
count()  %>%
arrange(desc(n))
ores %>%
mutate(commod1 = str_trim(commod1)) %>%
group_by(state,commod1) %>%
count()  %>%
arrange(desc(n)) %>%
slice(1:3)
ores_state <- ores %>%
mutate(commod1 = str_trim(commod1)) %>%
group_by(state,commod1) %>%
count()
ores_state <- ores %>%
mutate(commod1 = str_trim(commod1)) %>%
group_by(state,commod1) %>%
count()
ores_state %>%
group_by(state)
ores_state <- ores %>%
mutate(commod1 = str_trim(commod1)) %>%
group_by(state,commod1) %>%
count()
ores_state %>%
group_by(state) %>%
top_n(10,n)
ores_state <- ores %>%
mutate(commod1 = str_trim(commod1)) %>%
group_by(state,commod1) %>%
count()
ores_state %>%
group_by(state) %>%
top_n(10,n)%>%
merge(state_id,by = "state", all.y = TRUE)
ores_state <- ores_state[,c(1,2,3,4)]
ores_state <- ores %>%
mutate(commod1 = str_trim(commod1)) %>%
group_by(state,commod1) %>%
count()
ores_state %>%
group_by(state) %>%
top_n(10,n)%>%
merge(state_id,by = "state", all.y = TRUE)
ores_state <- ores_state[,c(1,2,3)]
colnames(ores_state) <- c("state","Metal","Number Of Deposits","id")
ores_state <- ores %>%
mutate(commod1 = str_trim(commod1)) %>%
group_by(state,commod1) %>%
count()
ores_state %>%
group_by(state) %>%
top_n(10,n)%>%
merge(state_id,by = "state", all.y = TRUE)
ores_state <- ores_state[,c(1,2,3)]
colnames(ores_state) <- c("state","Metal","Number Of Deposits")
write.csv(ores_state,"alldeposits_bystate.csv")
ores_state <- ores %>%
mutate(commod1 = str_trim(commod1)) %>%
group_by(state,commod1) %>%
count()
ores_state %>%
group_by(state) %>%
top_n(10,n)%>%
merge(state_id,by = "state", all.y = TRUE)
ores_state <- ores_state[,c(1,2,3)]
colnames(ores_state) <- c("state","Metal","Number Of Deposits")
write.csv(ores_state,"alldeposits_bystate.csv")
ores_state <- ores %>%
mutate(commod1 = str_trim(commod1)) %>%
group_by(state,commod1) %>%
count()
ores_state <- ores_state %>%
group_by(state) %>%
top_n(10,n)%>%
merge(state_id,by = "state", all.y = TRUE)
ores_state <- ores_state[,c(1,2,3)]
colnames(ores_state) <- c("state","Metal","Number Of Deposits")
write.csv(ores_state,"alldeposits_bystate.csv")
View(ores_state)
ores_state <- ores %>%
mutate(commod1 = str_trim(commod1)) %>%
group_by(state,commod1) %>%
count()
ores_state <- ores_state %>%
group_by(state) %>%
top_n(10,n)%>%
merge(state_id,by = "state", all.y = TRUE)
ores_state <- ores_state[,c(1,2,3)]
colnames(ores_state) <- c("state","Metal","Number Of Deposits")
write.csv(ores_state,"alldeposits_bystate.csv")
dir.create(temp <- tempfile())
ores %>%
group_by(state) %>%
mutate(commod1 = str_trim(commod1)) %>%
group_walk(~ write.csv(.x, paste0("state_deposits/",.y$state, ".csv")))
list.files(temp, pattern = "csv$")
ores %>%
group_by(state)%>%
count()
s_c <- ores %>%
group_by(state)%>%
count()
View(s_c)
